(()=>{"use strict";var e=null,t=null,n=null,o=null,d={width:1280,height:720},i={x:0,y:0},r=1;function l(){let t=window.innerWidth,n=window.innerHeight;d.width=t,d.height=n,e.canvas.width=t,e.canvas.height=n}!function(){if(e&&t&&n&&o)return;let d=document.getElementById("editor-canvas");e=d?.getContext("2d"),t=document.getElementById("editor-window"),n=document.getElementById("editor-canvas"),o=document.querySelector(":root"),l(),addEventListener("resize",l)}();const s="qwsertyuiopasdfghjklzxcvbnbmQWERETYUIOPASDFDGHJKJLZXCXVBNBM123454567890";function a(e=16){let t="";for(;t.length<e;)t+=s.charAt(Math.random()*s.length);return t}const c={x:0,y:0};function u(e){n.style.cursor=e}addEventListener("mousemove",(function(e){c.x=e.clientX,c.y=e.clientY})),addEventListener("mousedown",(e=>{let t=new CustomEvent("mousePressed",{detail:{button:e.button}});window.dispatchEvent(t)})),addEventListener("mouseup",(e=>{let t=new CustomEvent("mouseReleased",{detail:{button:e.button}});window.dispatchEvent(t)}));var y=[];function m(e){let n=function(e){return"string"!=typeof e?e:y.find((t=>t.token==e))}(e);if(!n)return;let o=document.getElementById(`block-${n.token}`);return o||(o=function(e){let n=document.createElement("div");return n.classList.add("block-element"),n.id=`block-${e.token}`,t.appendChild(n),n}(n)),o}function k(e,t,n){t=t||c.x,n=n||c.y;let o={token:a(),type:e,inputNodes:[],outputNodes:[],x:t,y:n};return y.push(o),function(e){m(e)}(o),o}function v(e){if(function(e){let t=m(e);t&&t.remove()}(e),"string"==typeof e)return y=y.filter(((t,n)=>t.token!=e)),!0;{const t=y.indexOf(e);if(-1!==t)return y.splice(t,1),!0}return!1}var h={active:!1,holding:!1,x:0,y:0};function f(){if(!h.holding)return;let e=c.x-h.x,t=c.y-h.y;i.x+=e/r,i.y+=t/r,h.x=c.x,h.y=c.y,o.style.setProperty("--board-x",`${i.x}px`),o.style.setProperty("--board-y",`${i.y}px`),requestAnimationFrame(f)}addEventListener("keyPressed",(e=>{" "==e.detail.key&&(u("grab"),h.active=!0)})),addEventListener("keyReleased",(e=>{" "==e.detail.key&&h.active&&(u("default"),h.active=!1)})),addEventListener("mousePressed",(e=>{0==e.detail.button&&h.active&&(h.holding=!0,h.x=c.x,h.y=c.y,requestAnimationFrame(f))})),addEventListener("mouseReleased",(e=>{0==e.detail.button&&h.holding&&(h.holding=!1)})),addEventListener("wheel",(e=>{var t,n;n=r-e.deltaY/400,t=Math.min(Math.max(n,.2),4),r=t,o.style.setProperty("--board-zoom",`${r}`)}));const E={};addEventListener("keydown",(e=>{E[e.key]=!0;let t=new CustomEvent("keyPressed",{detail:{key:e.key}});window.dispatchEvent(t)})),addEventListener("keyup",(e=>{E[e.key]=!1;let t=new CustomEvent("keyReleased",{detail:{key:e.key}});window.dispatchEvent(t)}));var g,b=1;function p(e,t){try{t()?console.log(`✔️ Test ${b} "${e}" passed`):console.log(`❌ Test ${b} "${e}" failed`)}catch(t){console.log(`❌ Test ${b} "${e}" failed: ${t}`)}b++}p("create block",(()=>"Player joined"==(g=k("Player joined")).type)),p("destroy block",(()=>v(g))),p("destroy block via token",(()=>v(g.token))),p("destroy invalid block",(()=>!v(null))),p("create block at cursor position",(()=>{let e=(g=k("Player joined")).x==c.x&&g.y==c.y;return v(g),e})),p("create block at 50x50 position",(()=>{let e=50==(g=k("Player joined",50,50)).x&&50==g.y;return v(g),e})),p("created block should create DOM element",(()=>{g=k("Player joined",50,50);let e=document.getElementById(`block-${g.token}`);return v(g),!!e})),p("destroying block should delete DOM element",(()=>{g=k("Player joined",50,50);let e=document.getElementById(`block-${g.token}`);v(g);let t=document.getElementById(`block-${g.token}`);return e&&!t})),p("create block for testing frontend purposes",(()=>!!(g=k("Player joined",50,50))))})();