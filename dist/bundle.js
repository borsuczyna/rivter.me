(()=>{"use strict";var e,t={};e={"Player joined":{name:"Player joined",hoverTip:"Event is triggered when player joins server",motionStart:!1,motionNext:!0,inputs:[],outputs:[{name:"Player",hoverTip:"Player that joined server",type:"player"}],isEvent:!0}},t={...t,...e};var n=null,o=null,i=null,r=null,d={width:1280,height:720},l={x:0,y:0},s=1;function a(){let e=window.innerWidth,t=window.innerHeight;d.width=e,d.height=t,n.canvas.width=e,n.canvas.height=t}!function(){if(n&&o&&i&&r)return;let e=document.getElementById("editor-canvas");n=e?.getContext("2d"),o=document.getElementById("editor-window"),i=document.getElementById("editor-canvas"),r=document.querySelector(":root"),a(),addEventListener("resize",a)}();const c="qwsertyuiopasdfghjklzxcvbnbmQWERETYUIOPASDFDGHJKJLZXCXVBNBM123454567890";function u(e=16){let t="";for(;t.length<e;)t+=c.charAt(Math.random()*c.length);return t}const y={x:0,y:0};function m(e){i.style.cursor=e}addEventListener("mousemove",(function(e){y.x=e.clientX,y.y=e.clientY})),addEventListener("mousedown",(e=>{let t=new CustomEvent("mousePressed",{detail:{button:e.button}});window.dispatchEvent(t)})),addEventListener("mouseup",(e=>{let t=new CustomEvent("mouseReleased",{detail:{button:e.button}});window.dispatchEvent(t)}));var v={active:!1,holding:!1,x:0,y:0};function p(e,t){return{x:(e-d.width/2-l.x*s)/s,y:(t-d.height/2-l.y*s)/s}}function h(){if(!v.holding)return;let e=y.x-v.x,t=y.y-v.y;l.x+=e/s,l.y+=t/s,v.x=y.x,v.y=y.y,r.style.setProperty("--board-x",`${l.x}px`),r.style.setProperty("--board-y",`${l.y}px`),requestAnimationFrame(h)}addEventListener("keyPressed",(e=>{" "==e.detail.key&&(m("grab"),v.active=!0)})),addEventListener("keyReleased",(e=>{" "==e.detail.key&&v.active&&(m("default"),v.active=!1)})),addEventListener("mousePressed",(e=>{0==e.detail.button&&v.active&&(v.holding=!0,v.x=y.x,v.y=y.y,requestAnimationFrame(h))})),addEventListener("mouseReleased",(e=>{0==e.detail.button&&v.holding&&(v.holding=!1)})),addEventListener("wheel",(e=>{var t,n;n=s-e.deltaY/400,t=Math.min(Math.max(n,.2),4),s=t,r.style.setProperty("--board-zoom",`${s}`)}));var k=[];function x(e){let n=g(e);if(!n)return;let i=document.getElementById(`block-${n.token}`);return i||(i=function(e){let n=(i=e.type,t[i]);var i;if(!n)return;let r=document.createElement("div"),d=document.createElement("div");return r.classList.add("block-element"),r.id=`block-${e.token}`,o.appendChild(r),d.innerText=n.name,d.classList.add("block-title"),r.appendChild(d),r}(n)),i}function f(e,t,n){t=t||p(y.x,y.y).x,n=n||p(y.x,y.y).y;let o={token:u(),type:e,inputNodes:[],outputNodes:[],x:t,y:n};return k.push(o),function(e){let t=x(e),n=g(e);t&&(t.style.setProperty("--position-x",`${n.x}px`),t.style.setProperty("--position-y",`${n.y}px`))}(o),o}function g(e){return"string"!=typeof e?e:k.find((t=>t.token==e))}function E(e){if(function(e){let t=x(e);t&&t.remove()}(e),"string"==typeof e)return k=k.filter(((t,n)=>t.token!=e)),!0;{const t=k.indexOf(e);if(-1!==t)return k.splice(t,1),!0}return!1}const w={};addEventListener("keydown",(e=>{w[e.key]=!0;let t=new CustomEvent("keyPressed",{detail:{key:e.key}});window.dispatchEvent(t)})),addEventListener("keyup",(e=>{w[e.key]=!1;let t=new CustomEvent("keyReleased",{detail:{key:e.key}});window.dispatchEvent(t)}));var b,$=1;async function P(e,t){if("AsyncFunction"===t.constructor.name){try{await t()?console.log(`✔️ Test ${$} "${e}" passed`):console.log(`❌ Test ${$} "${e}" failed`)}catch(t){console.log(`❌ Test ${$} "${e}" failed: ${t}`)}$++}else{try{t()?console.log(`✔️ Test ${$} "${e}" passed`):console.log(`❌ Test ${$} "${e}" failed`)}catch(t){console.log(`❌ Test ${$} "${e}" failed: ${t}`)}$++}}P("create block",(()=>"Player joined"==(b=f("Player joined")).type)),P("destroy block",(()=>E(b))),P("destroy block via token",(()=>E(b.token))),P("destroy invalid block",(()=>!E(null))),P("create block at 50x50 position",(()=>{let e=50==(b=f("Player joined",50,50)).x&&50==b.y;return E(b),e})),P("created block should create DOM element",(()=>{b=f("Player joined",50,50);let e=document.getElementById(`block-${b.token}`);return E(b),!!e})),P("destroying block should delete DOM element",(()=>{b=f("Player joined",50,50);let e=document.getElementById(`block-${b.token}`);E(b);let t=document.getElementById(`block-${b.token}`);return e&&!t})),P("create block for testing frontend purposes",(()=>!!(b=f("Player joined",50,50)))),P("clicking should create block on cursor position",(async()=>{let e=new Promise(((e,t)=>{addEventListener("mousePressed",(t=>{let n=f("Player joined");e(n.x==p(y.x,y.y).x&&n.y==p(y.x,y.y).y)}))}));return await e}))})();